SELECT 
    CASE 
        WHEN "amount" IN (4198, 3398) THEN 'Assisted sale' 
        ELSE 'Non-assisted sale' 
    END AS "Conversion", 
    COUNT(*) AS "Count", 
    SUM("amount") AS "Revenue" 
FROM "Payment" 
WHERE "createdAt" >= {{moment(DatePicker1.selectedDate).format("YYYY-MM-DD")}}::date - interval '330 minutes' 
  AND "createdAt" <= {{moment(DatePicker2.selectedDate).format("YYYY-MM-DD")}}::date + interval '1110 minutes' 
  AND "status" = 'responseReceivedSuccess' 
  AND "paymentForId" = 4016 
GROUP BY 
    CASE 
        WHEN "amount" IN (4198, 3398) THEN 'Assisted sale' 
        ELSE 'Non-assisted sale' 
    END

UNION ALL

SELECT 
    'Total' AS "Conversion", 
    SUM("Count"), 
    SUM("Revenue")
FROM (
    SELECT 
        COUNT(*) AS "Count", 
        SUM("amount") AS "Revenue" 
    FROM "Payment" 
    WHERE "createdAt" >= {{moment(DatePicker1.selectedDate).format("YYYY-MM-DD")}}::date - interval '330 minutes' 
      AND "createdAt" <= {{moment(DatePicker2.selectedDate).format("YYYY-MM-DD")}}::date + interval '1110 minutes' 
      AND "status" = 'responseReceivedSuccess' 
      AND "paymentForId" = 4016 
    GROUP BY 
        CASE 
            WHEN "amount" IN (4198, 3398) THEN 'Assisted sale' 
            ELSE 'Non-assisted sale' 
        END
) AS subquery;